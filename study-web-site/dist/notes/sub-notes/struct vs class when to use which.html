<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Senior .NET study guide for Struct Vs Class When To Use Which" />
  <meta name="theme-color" content="#0f172a" />
  <title>Struct Vs Class When To Use Which | C# Interview Prep Cheat Sheet</title>
  <link rel="manifest" href="..\..\assets/manifest.webmanifest" />
  <script>
    (() => {
      const supported = ['dark2', 'light', 'dark'];
      const saved = sessionStorage.getItem('study-theme');
      const normalized = saved === 'midnight' ? 'dark2' : saved;
      const fallback = 'light';
      const initial = supported.includes(normalized) ? normalized : fallback;
      document.documentElement.dataset.theme = initial;
      window.__studyTheme = initial;
    })();
  </script>
  <link rel="stylesheet" href="..\..\assets/styles.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body>
  <header class="site-header">
    <div>
      <p class="eyebrow">C# Interview Prep</p>
      <h1>Senior .NET Study Portal</h1>
      <p class="subtitle">Ultimate cheat sheets, patterns, and interview-ready scenarios in one place.</p>
    </div>
    <div class="header-actions">
      <div class="theme-switcher" aria-label="Theme selector">
        <label for="theme-select" class="theme-label">Theme</label>
        <select id="theme-select" class="theme-select">
          <option value="dark2">Dark 2</option>
          <option value="light">Light</option>
          <option value="dark">Dark</option>
        </select>
      </div>
      <div class="badge">Fast recall</div>
    </div>
  </header>
  <div class="layout">
    <nav class="sidebar">
      <div class="sidebar-section">
        <h2>Navigation</h2>
        <div class="search-hint">Use Ctrl/Cmd + F for quick lookup</div>
        <div class="sidebar-scroll"><div class="nav-groups"><div class="sidebar-group" data-group="notes">
      <button class="sidebar-group__header" type="button" aria-expanded="false">
        <span>Notes</span>
        <span class="chevron" aria-hidden="true"></span>
      </button>
      <ul class="sidebar-group__items" hidden><li><a class="nav-link" href="..\../notes/core-concepts.html">Core Concepts</a></li><li><a class="nav-link" href="..\../notes/error-handling.html">Error Handling</a></li><li><a class="nav-link" href="..\../notes/logging.html">Logging</a></li><li><a class="nav-link" href="..\../notes/testing-strategies.html">Testing Strategies</a></li></ul>
    </div><div class="sidebar-group" data-group="notes-automapper">
      <button class="sidebar-group__header" type="button" aria-expanded="false">
        <span>Notes / Automapper</span>
        <span class="chevron" aria-hidden="true"></span>
      </button>
      <ul class="sidebar-group__items" hidden><li><a class="nav-link" href="..\../notes/Automapper/AutoMapper.html">AutoMapper</a></li></ul>
    </div><div class="sidebar-group" data-group="notes-big-o-complexity">
      <button class="sidebar-group__header" type="button" aria-expanded="false">
        <span>Notes / Big O Complexity</span>
        <span class="chevron" aria-hidden="true"></span>
      </button>
      <ul class="sidebar-group__items" hidden><li><a class="nav-link" href="..\../notes/Big-O-Complexity/index.html">Big O Complexity</a></li><li><a class="nav-link" href="..\../notes/Big-O-Complexity/O1-Constant-Time.html">O1 Constant Time</a></li><li><a class="nav-link" href="..\../notes/Big-O-Complexity/OLogN-Logarithmic-Time.html">OLogN Logarithmic Time</a></li><li><a class="nav-link" href="..\../notes/Big-O-Complexity/ON-Linear-Time.html">ON Linear Time</a></li><li><a class="nav-link" href="..\../notes/Big-O-Complexity/ON2-Quadratic-Time.html">ON2 Quadratic Time</a></li><li><a class="nav-link" href="..\../notes/Big-O-Complexity/ONLogN-Linearithmic-Time.html">ONLogN Linearithmic Time</a></li><li><a class="nav-link" href="..\../notes/Big-O-Complexity/Space-Complexity.html">Space Complexity</a></li></ul>
    </div><div class="sidebar-group" data-group="notes-clean-architecture">
      <button class="sidebar-group__header" type="button" aria-expanded="false">
        <span>Notes / Clean Architecture</span>
        <span class="chevron" aria-hidden="true"></span>
      </button>
      <ul class="sidebar-group__items" hidden><li><a class="nav-link" href="..\../notes/Clean-Architecture/index.html">Clean Architecture</a></li></ul>
    </div><div class="sidebar-group" data-group="notes-collections-and-enumerables">
      <button class="sidebar-group__header" type="button" aria-expanded="false">
        <span>Notes / Collections And Enumerables</span>
        <span class="chevron" aria-hidden="true"></span>
      </button>
      <ul class="sidebar-group__items" hidden><li><a class="nav-link" href="..\../notes/Collections-And-Enumerables/index.html">Collections And Enumerables</a></li><li><a class="nav-link" href="..\../notes/Collections-And-Enumerables/ICollection.html">ICollection</a></li><li><a class="nav-link" href="..\../notes/Collections-And-Enumerables/IEnumerable.html">IEnumerable</a></li><li><a class="nav-link" href="..\../notes/Collections-And-Enumerables/IList.html">IList</a></li><li><a class="nav-link" href="..\../notes/Collections-And-Enumerables/IQueryable.html">IQueryable</a></li><li><a class="nav-link" href="..\../notes/Collections-And-Enumerables/IReadOnly.html">IReadOnly</a></li></ul>
    </div><div class="sidebar-group" data-group="notes-design-patterns">
      <button class="sidebar-group__header" type="button" aria-expanded="false">
        <span>Notes / Design Patterns</span>
        <span class="chevron" aria-hidden="true"></span>
      </button>
      <ul class="sidebar-group__items" hidden><li><a class="nav-link" href="..\../notes/Design-Patterns/CQRS Pattern.html">CQRS Pattern</a></li><li><a class="nav-link" href="..\../notes/Design-Patterns/Decorator Pattern.html">Decorator Pattern</a></li><li><a class="nav-link" href="..\../notes/Design-Patterns/Factory Pattern.html">Factory Pattern</a></li><li><a class="nav-link" href="..\../notes/Design-Patterns/Mediator Pattern.html">Mediator Pattern</a></li><li><a class="nav-link" href="..\../notes/Design-Patterns/Observer Pattern.html">Observer Pattern</a></li><li><a class="nav-link" href="..\../notes/Design-Patterns/Strategy Pattern.html">Strategy Pattern</a></li></ul>
    </div><div class="sidebar-group" data-group="notes-dry">
      <button class="sidebar-group__header" type="button" aria-expanded="false">
        <span>Notes / DRY</span>
        <span class="chevron" aria-hidden="true"></span>
      </button>
      <ul class="sidebar-group__items" hidden><li><a class="nav-link" href="..\../notes/DRY/index.html">DRY</a></li></ul>
    </div><div class="sidebar-group" data-group="notes-fluentvalidation">
      <button class="sidebar-group__header" type="button" aria-expanded="false">
        <span>Notes / FluentValidation</span>
        <span class="chevron" aria-hidden="true"></span>
      </button>
      <ul class="sidebar-group__items" hidden><li><a class="nav-link" href="..\../notes/FluentValidation/FluentValidation.html">FluentValidation</a></li></ul>
    </div><div class="sidebar-group" data-group="notes-memory-allocation-discipline">
      <button class="sidebar-group__header" type="button" aria-expanded="false">
        <span>Notes / Memory Allocation Discipline</span>
        <span class="chevron" aria-hidden="true"></span>
      </button>
      <ul class="sidebar-group__items" hidden><li><a class="nav-link" href="..\../notes/Memory-Allocation-Discipline/index.html">Memory Allocation Discipline</a></li><li><a class="nav-link" href="..\../notes/Memory-Allocation-Discipline/Memory Allocation Discipline Example.html">Memory Allocation Discipline Example</a></li><li><a class="nav-link" href="..\../notes/Memory-Allocation-Discipline/Memory Allocation Discipline Example Async.html">Memory Allocation Discipline Example Async</a></li></ul>
    </div><div class="sidebar-group" data-group="notes-solid">
      <button class="sidebar-group__header" type="button" aria-expanded="false">
        <span>Notes / SOLID</span>
        <span class="chevron" aria-hidden="true"></span>
      </button>
      <ul class="sidebar-group__items" hidden><li><a class="nav-link" href="..\../notes/SOLID/D-Dependency-Inversion-Principle-DIP.html">D Dependency Inversion Principle DIP</a></li><li><a class="nav-link" href="..\../notes/SOLID/I-Interface-Segregation-Principle-ISP.html">I Interface Segregation Principle ISP</a></li><li><a class="nav-link" href="..\../notes/SOLID/L-Liskov-Substitution-Principle-LSP.html">L Liskov Substitution Principle LSP</a></li><li><a class="nav-link" href="..\../notes/SOLID/O-Open-Closed-Principle-OCP.html">O Open Closed Principle OCP</a></li><li><a class="nav-link" href="..\../notes/SOLID/S-Single-Responsibility-Principle-SRP.html">S Single Responsibility Principle SRP</a></li><li><a class="nav-link" href="..\../notes/SOLID/index.html">SOLID</a></li></ul>
    </div><div class="sidebar-group is-open" data-group="notes-sub-notes">
      <button class="sidebar-group__header" type="button" aria-expanded="true">
        <span>Notes / Sub Notes</span>
        <span class="chevron" aria-hidden="true"></span>
      </button>
      <ul class="sidebar-group__items"><li><a class="nav-link" href="..\../notes/sub-notes/Async Await Deep Dive.html">Async Await Deep Dive</a></li><li><a class="nav-link" href="..\../notes/sub-notes/base-keyword.html">Base Keyword</a></li><li><a class="nav-link" href="..\../notes/sub-notes/CLR & Garbage Collector (GC).html">CLR & Garbage Collector (GC)</a></li><li><a class="nav-link" href="..\../notes/sub-notes/CLR & Garbage Collector (GC) Practical Example.html">CLR & Garbage Collector (GC) Practical Example</a></li><li><a class="nav-link" href="..\../notes/sub-notes/Dependency Injection Lifetimes.html">Dependency Injection Lifetimes</a></li><li><a class="nav-link" href="..\../notes/sub-notes/FIFO Queues in .NET.html">FIFO Queues In .NET</a></li><li><a class="nav-link" href="..\../notes/sub-notes/Forcing Garbage Collection.html">Forcing Garbage Collection</a></li><li><a class="nav-link" href="..\../notes/sub-notes/IDisposable Patterns.html">IDisposable Patterns</a></li><li><a class="nav-link" href="..\../notes/sub-notes/nameof-keyword.html">Nameof Keyword</a></li><li><a class="nav-link" href="..\../notes/sub-notes/NET Generational Garbage Collection (GC) Deep Dive.html">NET Generational Garbage Collection (GC) Deep Dive</a></li><li><a class="nav-link" href="..\../notes/sub-notes/RabbitMQ.html">RabbitMQ</a></li><li><a class="nav-link" href="..\../notes/sub-notes/Reflection Overview.html">Reflection Overview</a></li><li><a class="nav-link" href="..\../notes/sub-notes/Server vs Workstation GC.html">Server Vs Workstation GC</a></li><li><a class="nav-link" href="..\../notes/sub-notes/Sorted Collections Interview Notes.html">Sorted Collections Interview Notes</a></li><li><a class="nav-link" href="..\../notes/sub-notes/Sorting Algorithms.html">Sorting Algorithms</a></li><li><a class="nav-link active" href="..\../notes/sub-notes/struct vs class when to use which.html">Struct Vs Class When To Use Which</a></li><li><a class="nav-link" href="..\../notes/sub-notes/types.html">Types</a></li></ul>
    </div><div class="sidebar-group" data-group="notes-use-cases-massive-traffic">
      <button class="sidebar-group__header" type="button" aria-expanded="false">
        <span>Notes / Use Cases / Massive Traffic</span>
        <span class="chevron" aria-hidden="true"></span>
      </button>
      <ul class="sidebar-group__items" hidden><li><a class="nav-link" href="..\../notes/Use-Cases/massive-traffic/01-async-patterns.html">01 Async Patterns</a></li><li><a class="nav-link" href="..\../notes/Use-Cases/massive-traffic/02-backpressure-rate-limiting.html">02 Backpressure Rate Limiting</a></li><li><a class="nav-link" href="..\../notes/Use-Cases/massive-traffic/03-caching-strategies.html">03 Caching Strategies</a></li><li><a class="nav-link" href="..\../notes/Use-Cases/massive-traffic/04-database-scaling.html">04 Database Scaling</a></li><li><a class="nav-link" href="..\../notes/Use-Cases/massive-traffic/05-message-queues.html">05 Message Queues</a></li><li><a class="nav-link" href="..\../notes/Use-Cases/massive-traffic/06-resilience-patterns.html">06 Resilience Patterns</a></li><li><a class="nav-link" href="..\../notes/Use-Cases/massive-traffic/07-observability.html">07 Observability</a></li><li><a class="nav-link" href="..\../notes/Use-Cases/massive-traffic/08-complete-example.html">08 Complete Example</a></li><li><a class="nav-link" href="..\../notes/Use-Cases/massive-traffic/index.html">Massive Traffic</a></li></ul>
    </div><div class="sidebar-group" data-group="practice">
      <button class="sidebar-group__header" type="button" aria-expanded="false">
        <span>Practice</span>
        <span class="chevron" aria-hidden="true"></span>
      </button>
      <ul class="sidebar-group__items" hidden><li><a class="nav-link" href="..\../practice/answers.html">Answers</a></li><li><a class="nav-link" href="..\../practice/api-lifecycle.html">Api Lifecycle</a></li><li><a class="nav-link" href="..\../practice/async-resilience.html">Async Resilience</a></li><li><a class="nav-link" href="..\../practice/behavioral-questions.html">Behavioral Questions</a></li><li><a class="nav-link" href="..\../practice/code-assessment.html">Code Assessment</a></li><li><a class="nav-link" href="..\../practice/csharp-fundamentals.html">Csharp Fundamentals</a></li><li><a class="nav-link" href="..\../practice/csharp-system-design-questions.html">Csharp System Design Questions</a></li><li><a class="nav-link" href="..\../practice/data-layer.html">Data Layer</a></li><li><a class="nav-link" href="..\../practice/linq-collections.html">Linq Collections</a></li><li><a class="nav-link" href="..\../practice/messaging-integration.html">Messaging Integration</a></li><li><a class="nav-link" href="..\../practice/performance-memory.html">Performance Memory</a></li><li><a class="nav-link" href="..\../practice/index.html">Practice</a></li><li><a class="nav-link" href="..\../practice/PRACTICE-STRUCTURE.html">PRACTICE STRUCTURE</a></li><li><a class="nav-link" href="..\../practice/questions.html">Questions</a></li><li><a class="nav-link" href="..\../practice/README.html">README</a></li><li><a class="nav-link" href="..\../practice/replace int without variable.html">Replace Int Without Variable</a></li><li><a class="nav-link" href="..\../practice/struct vs class questions and answers.html">Struct Vs Class Questions And Answers</a></li><li><a class="nav-link" href="..\../practice/system-design.html">System Design</a></li><li><a class="nav-link" href="..\../practice/trading-domain.html">Trading Domain</a></li></ul>
    </div><div class="sidebar-group" data-group="practice-advanced-topics">
      <button class="sidebar-group__header" type="button" aria-expanded="false">
        <span>Practice / Advanced Topics</span>
        <span class="chevron" aria-hidden="true"></span>
      </button>
      <ul class="sidebar-group__items" hidden><li><a class="nav-link" href="..\../practice/advanced-topics/async-await-exercises.html">Async Await Exercises</a></li></ul>
    </div><div class="sidebar-group" data-group="practice-automapper">
      <button class="sidebar-group__header" type="button" aria-expanded="false">
        <span>Practice / Automapper</span>
        <span class="chevron" aria-hidden="true"></span>
      </button>
      <ul class="sidebar-group__items" hidden><li><a class="nav-link" href="..\../practice/Automapper/index.html">Automapper</a></li></ul>
    </div><div class="sidebar-group" data-group="practice-big-o-complexity">
      <button class="sidebar-group__header" type="button" aria-expanded="false">
        <span>Practice / Big O Complexity</span>
        <span class="chevron" aria-hidden="true"></span>
      </button>
      <ul class="sidebar-group__items" hidden><li><a class="nav-link" href="..\../practice/Big-O-Complexity/index.html">Big O Complexity</a></li><li><a class="nav-link" href="..\../practice/Big-O-Complexity/O1-Constant-Time-Exercises.html">O1 Constant Time Exercises</a></li><li><a class="nav-link" href="..\../practice/Big-O-Complexity/OLogN-Logarithmic-Time-Exercises.html">OLogN Logarithmic Time Exercises</a></li><li><a class="nav-link" href="..\../practice/Big-O-Complexity/ON-Linear-Time-Exercises.html">ON Linear Time Exercises</a></li><li><a class="nav-link" href="..\../practice/Big-O-Complexity/ON2-Quadratic-Time-Exercises.html">ON2 Quadratic Time Exercises</a></li><li><a class="nav-link" href="..\../practice/Big-O-Complexity/ONLogN-Linearithmic-Time-Exercises.html">ONLogN Linearithmic Time Exercises</a></li></ul>
    </div><div class="sidebar-group" data-group="practice-clean-architecture">
      <button class="sidebar-group__header" type="button" aria-expanded="false">
        <span>Practice / Clean Architecture</span>
        <span class="chevron" aria-hidden="true"></span>
      </button>
      <ul class="sidebar-group__items" hidden><li><a class="nav-link" href="..\../practice/Clean-Architecture/index.html">Clean Architecture</a></li></ul>
    </div><div class="sidebar-group" data-group="practice-collections-and-enumerables">
      <button class="sidebar-group__header" type="button" aria-expanded="false">
        <span>Practice / Collections And Enumerables</span>
        <span class="chevron" aria-hidden="true"></span>
      </button>
      <ul class="sidebar-group__items" hidden><li><a class="nav-link" href="..\../practice/Collections-And-Enumerables/index.html">Collections And Enumerables</a></li></ul>
    </div><div class="sidebar-group" data-group="practice-design-patterns">
      <button class="sidebar-group__header" type="button" aria-expanded="false">
        <span>Practice / Design Patterns</span>
        <span class="chevron" aria-hidden="true"></span>
      </button>
      <ul class="sidebar-group__items" hidden><li><a class="nav-link" href="..\../practice/Design-Patterns/Decorator-Pattern-Exercises.html">Decorator Pattern Exercises</a></li><li><a class="nav-link" href="..\../practice/Design-Patterns/index.html">Design Patterns</a></li><li><a class="nav-link" href="..\../practice/Design-Patterns/Factory-Pattern-Exercises.html">Factory Pattern Exercises</a></li><li><a class="nav-link" href="..\../practice/Design-Patterns/Mediator-Pattern-Exercises.html">Mediator Pattern Exercises</a></li><li><a class="nav-link" href="..\../practice/Design-Patterns/Observer-Pattern-Exercises.html">Observer Pattern Exercises</a></li><li><a class="nav-link" href="..\../practice/Design-Patterns/Strategy-Pattern-Exercises.html">Strategy Pattern Exercises</a></li></ul>
    </div><div class="sidebar-group" data-group="practice-fluentvalidation">
      <button class="sidebar-group__header" type="button" aria-expanded="false">
        <span>Practice / FluentValidation</span>
        <span class="chevron" aria-hidden="true"></span>
      </button>
      <ul class="sidebar-group__items" hidden><li><a class="nav-link" href="..\../practice/FluentValidation/index.html">FluentValidation</a></li></ul>
    </div><div class="sidebar-group" data-group="practice-solid">
      <button class="sidebar-group__header" type="button" aria-expanded="false">
        <span>Practice / SOLID</span>
        <span class="chevron" aria-hidden="true"></span>
      </button>
      <ul class="sidebar-group__items" hidden><li><a class="nav-link" href="..\../practice/SOLID/S-Single-Responsibility-Principle-Exercises.html">S Single Responsibility Principle Exercises</a></li><li><a class="nav-link" href="..\../practice/SOLID/index.html">SOLID</a></li></ul>
    </div></div></div>
      </div>
    </nav>
    <main class="content">
      <article class="card">
        <div class="breadcrumbs">notes\sub-notes\struct vs class when to use which.md</div>
        <h2>Struct Vs Class When To Use Which</h2>
        <div class="toc-label">Rapid overview</div>
        <div class="toc"><ul class="toc-list"><li class="level-2"><a href="#conceptual-summary">ğŸ§  Conceptual Summary</a></li><li class="level-2"><a href="#practical-explanation-how-clr-handles-them">âš™ï¸ Practical Explanation (How CLR Handles Them)</a></li><li class="level-3"><a href="#struct">ğŸ§© `struct`</a></li><li class="level-3"><a href="#class">ğŸ§© `class`</a></li><li class="level-2"><a href="#performance-and-design-implications">âš¡ Performance and Design Implications</a></li><li class="level-3"><a href="#when-to-use-struct">âœ… When to use `struct`</a></li><li class="level-3"><a href="#when-not-to-use-struct">ğŸš« When NOT to use `struct`</a></li><li class="level-3"><a href="#boxing-and-hidden-allocations">âš ï¸ Boxing and Hidden Allocations</a></li><li class="level-2"><a href="#real-world-example-hfm-context">ğŸ§© Real-World Example (HFM context)</a></li><li class="level-2"><a href="#memory-visualization">ğŸ§© Memory Visualization</a></li><li class="level-2"><a href="#senior-level-20-second-summary-how-to-answer-in-interview">ğŸ¯ Senior-level 20-second summary (how to answer in interview)</a></li><li class="level-1"><a href="#memory-behavior-struct-vs-class">ğŸ§© Memory Behavior: `struct` vs `class`</a></li><li class="level-2"><a href="#1-basic-memory-layout">1ï¸âƒ£ Basic memory layout</a></li><li class="level-2"><a href="#questions-answers">Questions & Answers</a></li><li class="level-2"><a href="#2-assignment-behavior">2ï¸âƒ£ Assignment behavior</a></li><li class="level-3"><a href="#struct-value-type">âœ… Struct (value type)</a></li><li class="level-3"><a href="#class-reference-type">âœ… Class (reference type)</a></li><li class="level-2"><a href="#3-struct-inside-a-class-inline-layout">3ï¸âƒ£ Struct inside a class (inline layout)</a></li><li class="level-2"><a href="#4-passing-to-methods">4ï¸âƒ£ Passing to methods</a></li><li class="level-2"><a href="#5-heap-fragmentation-and-gc-difference">5ï¸âƒ£ Heap fragmentation and GC difference</a></li><li class="level-2"><a href="#6-summary-diagram">6ï¸âƒ£ âš™ï¸ Summary Diagram</a></li><li class="level-2"><a href="#quick-whiteboard-pitch-for-your-interview">ğŸ§  Quick â€œwhiteboard pitchâ€ for your interview</a></li></ul></div>
        <h2 id="conceptual-summary">ğŸ§  Conceptual Summary</h2>
<table><thead><tr><th>Feature</th><th><strong><code>struct</code></strong></th><th><strong><code>class</code></strong></th></tr></thead><tbody><tr><td><strong>Type category</strong></td><td>Value type</td><td>Reference type</td></tr><tr><td><strong>Memory allocation</strong></td><td>Stored <strong>inline</strong> (stack, or inside another object)</td><td>Stored on <strong>heap</strong>, referenced via pointer</td></tr><tr><td><strong>Default behavior</strong></td><td>Copied by <strong>value</strong> (creates a full copy)</td><td>Copied by <strong>reference</strong> (points to same object)</td></tr><tr><td><strong>Nullability</strong></td><td>Cannot be <code>null</code> (unless <code>Nullable&lt;T&gt;</code>)</td><td>Can be <code>null</code></td></tr><tr><td><strong>Inheritance</strong></td><td>Cannot inherit from another struct or class; only from <code>ValueType</code></td><td>Supports inheritance and polymorphism</td></tr><tr><td><strong>Interfaces</strong></td><td>Can implement interfaces</td><td>Can implement interfaces and base classes</td></tr><tr><td><strong>Default constructor</strong></td><td>Cannot define a custom parameterless constructor (C# 10 adds limited support)</td><td>Can freely define constructors</td></tr><tr><td><strong>Finalizer / Destructor</strong></td><td>Not supported</td><td>Supported</td></tr><tr><td><strong>GC behavior</strong></td><td>Usually short-lived, reclaimed when out of scope</td><td>Managed by the <strong>Garbage Collector</strong></td></tr><tr><td><strong>Boxing / Unboxing</strong></td><td>Converting to/from object/interface causes allocation</td><td>No boxing/unboxing issues</td></tr><tr><td><strong>Thread safety</strong></td><td>Safer for small immutable data</td><td>Reference types require synchronization if shared</td></tr></tbody></table>
<p>---</p>
<h2 id="practical-explanation-how-clr-handles-them">âš™ï¸ Practical Explanation (How CLR Handles Them)</h2>
<h3 id="struct">ğŸ§© <code>struct</code></h3>
<ul><li>Lives <strong>inline</strong> â€” if itâ€™s a local variable, itâ€™s on the <strong>stack</strong>; if itâ€™s a field in another object, itâ€™s inside that objectâ€™s memory layout.</li><li>When passed to a method, <strong>a full copy is made</strong> (unless passed by <code>ref</code> or <code>in</code>).</li><li>Ideal for <strong>small, immutable, lightweight data</strong> â€” e.g., coordinates, ticks, prices, GUIDs.</li></ul>
<p><strong>Example:</strong></p>
<pre class="language-csharp"><code class="language-csharp">struct Point
{
    public int X;
    public int Y;
}</code></pre>
<p>Each <code>Point</code> lives inline â€” no GC pressure.</p>
<p>---</p>
<h3 id="class">ğŸ§© <code>class</code></h3>
<ul><li>Lives on the <strong>managed heap</strong>. Variables hold a <strong>reference (pointer)</strong> to the actual object.</li><li>Passed around by reference, so multiple variables can point to the same instance.</li><li>Managed by the <strong>Garbage Collector</strong>.</li></ul>
<p><strong>Example:</strong></p>
<pre class="language-csharp"><code class="language-csharp">class Order
{
    public string Symbol { get; set; }
    public double Price { get; set; }
}</code></pre>
<p>Each <code>Order</code> allocation hits the heap and is tracked by the GC.</p>
<p>---</p>
<h2 id="performance-and-design-implications">âš¡ Performance and Design Implications</h2>
<h3 id="when-to-use-struct">âœ… When to use <code>struct</code></h3>
<p>Use when:</p>
<ul><li>The object is <strong>small (â‰¤ 16 bytes typically)</strong>.</li><li>Itâ€™s <strong>immutable</strong>.</li><li>Youâ€™ll create <strong>many</strong> of them (e.g., millions per second) and want <strong>no GC overhead</strong>.</li><li>Value semantics make sense (copying creates independence).</li></ul>
<p><strong>Example (trading context):</strong></p>
<pre class="language-csharp"><code class="language-csharp">readonly struct Tick
{
    public string Symbol { get; }
    public double Bid { get; }
    public double Ask { get; }
}</code></pre>
<p>Each <code>Tick</code> represents an immutable market data point. Perfect as a <code>struct</code>.</p>
<p>---</p>
<h3 id="when-not-to-use-struct">ğŸš« When NOT to use <code>struct</code></h3>
<p>Avoid when:</p>
<ul><li>Itâ€™s large (lots of fields) â†’ copying becomes expensive.</li><li>You need polymorphism, inheritance, or shared references.</li><li>You mutate the same instance in multiple places.</li></ul>
<p>---</p>
<h3 id="boxing-and-hidden-allocations">âš ï¸ Boxing and Hidden Allocations</h3>
<p>When a struct is treated as an <code>object</code> or cast to an interface, it gets <strong>boxed</strong> â€” copied onto the heap.</p>
<pre class="language-csharp"><code class="language-csharp">struct Point { public int X, Y; }

object obj = new Point(); // BOXED: allocates on heap
Point p = (Point)obj;     // UNBOXED: copy back to stack</code></pre>
<p>So: <strong>value types are not automatically zero-GC</strong> â€” you must use them carefully.</p>
<p>---</p>
<h2 id="real-world-example-hfm-context">ğŸ§© Real-World Example (HFM context)</h2>
<p>If youâ€™re processing <strong>millions of tick messages</strong> per second:</p>
<ul><li>Use a <code>struct</code> (or <code>readonly struct</code>) for individual ticks (lightweight, immutable).</li><li>Use a <code>class</code> for services and entities that manage state, like <code>OrderBook</code>, <code>TradeSession</code>, or <code>CacheManager</code>.</li></ul>
<p><strong>Example:</strong></p>
<pre class="language-csharp"><code class="language-csharp">readonly struct Tick
{
    public string Symbol { get; init; }
    public double Bid { get; init; }
    public double Ask { get; init; }
}

class PriceFeedProcessor
{
    private readonly List&lt;Tick&gt; _ticks = new();

    public void OnTick(Tick tick) =&gt; _ticks.Add(tick);
}</code></pre>
<p>---</p>
<h2 id="memory-visualization">ğŸ§© Memory Visualization</h2>
<pre class="language-csharp"><code class="language-csharp">Stack:
 â”œâ”€ Tick t1 { X=1, Y=2 }   (struct: inline)
 â”œâ”€ Tick t2 = t1 (copied!)
 â””â”€ Order ref â”€â”
               â–¼
Heap:
 â””â”€ { Symbol=&quot;EURUSD&quot;, Price=1.0734 }  (class: heap object)</code></pre>
<p>---</p>
<h2 id="senior-level-20-second-summary-how-to-answer-in-interview">ğŸ¯ Senior-level 20-second summary (how to answer in interview)</h2>
<blockquote><p>â€œA struct is a <strong>value type</strong>, stored inline and copied by value â€” great for <strong>small, immutable data</strong> and <strong>reducing GC pressure</strong>. A class is a <strong>reference type</strong>, stored on the heap, supporting <strong>inheritance and polymorphism</strong>. Structs avoid GC but can cost more to copy if large, and boxing them defeats their advantage. In low-latency systems, we often use small structs like <code>Tick</code> or <code>Point</code> to keep memory tight and predictable.â€</p></blockquote>
<p>---</p>
<p>Would you like me to give you <strong>5 advanced interview questions</strong> around <code>struct</code> vs <code>class</code> (with answers), the kind might use to test your understanding of <strong>memory, GC, and performance</strong>?</p>
<p>Excellent â€” this visual explanation will make your answer <strong>stand out instantly</strong> in a senior-level C# interview (especially at, where they care about performance, GC, and data flow).</p>
<p>Letâ€™s walk through it step by step, from memory layout to how structs and classes behave under assignment and method calls.</p>
<p>---</p>
<h1 id="memory-behavior-struct-vs-class">ğŸ§© Memory Behavior: <code>struct</code> vs <code>class</code></h1>
<h2 id="1-basic-memory-layout">1ï¸âƒ£ Basic memory layout</h2>
<pre class="language-csharp"><code class="language-csharp">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Stack               â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ int x = 10;             â”‚  â”‚
â”‚ â”‚ Point p = {X=1,Y=2};    â”‚  â”‚  â† Struct (value type)
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚   (lives inline here)        â”‚
â”‚                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ Order o â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”¼â”€â”€â–º Heap
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Heap               â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ Order { Id=1, Price=99 }â”‚  â”‚  â† Class (reference type)
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>
<p><strong>Explanation:</strong></p>
<ul><li><strong>Struct (<code>Point</code>)</strong> is stored <strong>directly on the stack</strong> or inline within another object.</li><li><strong>Class (<code>Order</code>)</strong> is stored on the <strong>heap</strong>; variables on the stack hold a <em>reference</em> (pointer) to it.</li></ul>
<p>---</p>
<h2 id="questions-answers">Questions & Answers</h2>
<p><strong>Q: When should you choose a struct over a class?</strong></p>
<p>A: When the data is small (â‰¤16 bytes), immutable, frequently created, and benefits from value semantics. Structs reduce GC pressure by living inline and being collected with stack frames.</p>
<p><strong>Q: What pitfalls occur when structs are too large?</strong></p>
<p>A: Copies become expensive, especially when passing by value. This can negate performance gains and increase stack usage. Use <code>in</code>/<code>ref</code> parameters or switch to classes if the struct grows.</p>
<p><strong>Q: How does boxing affect struct performance?</strong></p>
<p>A: Boxing copies the struct onto the heap and allocates, defeating the GC benefits. Avoid passing structs to APIs expecting <code>object</code> or non-generic interfaces to prevent boxing.</p>
<p><strong>Q: Can structs have parameterless constructors?</strong></p>
<p>A: Starting with C# 10, yes, but they must be <code>public</code>/<code>private</code> and initialize all fields. Historically, structs always had an implicit default constructor. Remember that every struct has a zeroed default state.</p>
<p><strong>Q: How do you prevent copying when passing structs to methods?</strong></p>
<p>A: Use <code>in</code> (readonly ref) for read-only access, or <code>ref</code>/<code>ref readonly</code> when you need to mutate or avoid copies. This keeps performance predictable for larger structs.</p>
<p><strong>Q: Can structs inherit from classes?</strong></p>
<p>A: No. Structs are sealed value types that inherit from <code>ValueType</code>. They can implement interfaces but cannot participate in class inheritance hierarchies.</p>
<p><strong>Q: When do structs hurt cache locality?</strong></p>
<p>A: Rarelyâ€”they often improve locality. However, large structs embedded in arrays can cause cache misses due to size. Evaluate data layout to ensure structs remain lean.</p>
<p><strong>Q: How do you model optional structs?</strong></p>
<p>A: Use <code>Nullable&lt;T&gt;</code> (<code>Tick?</code>). It wraps the struct with a <code>HasValue</code> flag, allowing null-like semantics without resorting to classes.</p>
<p><strong>Q: What about mutability?</strong></p>
<p>A: Prefer immutable structs to avoid accidental copies followed by mutation. Mutable structs can lead to confusing bugs when copies diverge silently.</p>
<p><strong>Q: How do structs interact with pattern matching and deconstruction?</strong></p>
<p>A: They support <code>Deconstruct</code> methods and pattern matching just like classes. This makes them ergonomic for lightweight domain data while still keeping value semantics.</p>
<p>---</p>
<h2 id="2-assignment-behavior">2ï¸âƒ£ Assignment behavior</h2>
<h3 id="struct-value-type">âœ… Struct (value type)</h3>
<pre class="language-csharp"><code class="language-csharp">Point a = new Point { X = 1, Y = 2 };
Point b = a;    // copy!
b.X = 99;
Console.WriteLine(a.X); // 1 (a unaffected)</code></pre>
<p><strong>Memory:</strong></p>
<pre class="language-csharp"><code class="language-csharp">Stack:
 a { X=1, Y=2 }
 b { X=99, Y=2 }   â† completely separate copy</code></pre>
<ul><li>Structs are <strong>copied by value</strong>.</li><li>Each variable has its <strong>own independent copy</strong>.</li><li>No heap allocation â†’ no GC pressure.</li></ul>
<p>---</p>
<h3 id="class-reference-type">âœ… Class (reference type)</h3>
<pre class="language-csharp"><code class="language-csharp">Order o1 = new Order { Id = 1, Price = 99 };
Order o2 = o1;  // copy reference!
o2.Price = 120;
Console.WriteLine(o1.Price); // 120</code></pre>
<p><strong>Memory:</strong></p>
<pre class="language-csharp"><code class="language-csharp">Stack:
 o1 â”€â”
 o2 â”€â”˜â”€â”€â–º Heap: { Id=1, Price=120 }</code></pre>
<ul><li>Classes are <strong>copied by reference</strong> â€” both variables point to the same heap object.</li><li>Modifying one affects the other.</li></ul>
<p>---</p>
<h2 id="3-struct-inside-a-class-inline-layout">3ï¸âƒ£ Struct inside a class (inline layout)</h2>
<pre class="language-csharp"><code class="language-csharp">class Trade
{
    public string Symbol;
    public Point Position;
}</code></pre>
<p><strong>Memory:</strong></p>
<pre class="language-csharp"><code class="language-csharp">Heap: Trade
 â”œâ”€ Symbol â†’ &quot;EURUSD&quot;   (heap reference)
 â””â”€ Position { X=10, Y=20 }  (inline in Trade object)</code></pre>
<p><strong>Insight:</strong> Even though the struct is inside a class (on heap), its <strong>fields are embedded inline</strong> â€” not separate allocations. This reduces pointer indirection and helps cache locality.</p>
<p>---</p>
<h2 id="4-passing-to-methods">4ï¸âƒ£ Passing to methods</h2>
<pre class="language-csharp"><code class="language-csharp">void Move(Point p) { p.X += 10; } // copy!
void MoveRef(ref Point p) { p.X += 10; } // modifies original</code></pre>
<p><strong>Memory visualization:</strong></p>
<pre class="language-csharp"><code class="language-csharp">By value (copy):
 Caller: a { X=1 }
 Method: p { X=1 } â†’ modified to X=11 (copy destroyed)

By ref:
 Caller: a { X=1 }
 Method: p â”€â”
             â””â”€ modifies same memory â†’ X=11 persists</code></pre>
<p>ğŸ’¡ <strong>Interview tip:</strong></p>
<blockquote><p>â€œStructs are copied on method calls unless passed by <code>ref</code> or <code>in</code>. Large structs should be passed by <code>in</code> to avoid copy overhead â€” especially in tight loops or latency-critical code.â€</p></blockquote>
<p>---</p>
<h2 id="5-heap-fragmentation-and-gc-difference">5ï¸âƒ£ Heap fragmentation and GC difference</h2>
<pre class="language-csharp"><code class="language-csharp">Structs:
[Stack]
[Stack frame destroyed â†’ data gone instantly]
â†’ No GC involvement.

Classes:
[Heap]
[Objects live until unreachable]
â†’ GC scans and collects them (Gen0â†’Gen1â†’Gen2)</code></pre>
<p><strong>Key insight:</strong></p>
<ul><li>Structs vanish when they go out of scope â†’ <strong>predictable lifetime</strong>.</li><li>Classes depend on GC cycles â†’ <strong>non-deterministic</strong> reclamation.</li><li>Overusing classes in a high-frequency path (like market ticks) causes <strong>GC churn and pauses</strong>.</li></ul>
<p>---</p>
<h2 id="6-summary-diagram">6ï¸âƒ£ âš™ï¸ Summary Diagram</h2>
<pre class="language-csharp"><code class="language-csharp">STRUCT (Value Type)
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚ Inline Data  â”‚
 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
 â”‚ Copied on =  â”‚
 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
 â”‚ No GC        â”‚
 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
 â”‚ Pass by ref  â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†“
  Great for small immutable data

CLASS (Reference Type)
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚ Heap Object  â”‚
 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
 â”‚ Copied ref   â”‚
 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
 â”‚ Managed by GCâ”‚
 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
 â”‚ Supports OOP â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†“
  Great for shared mutable state</code></pre>
<p>---</p>
<h2 id="quick-whiteboard-pitch-for-your-interview">ğŸ§  Quick â€œwhiteboard pitchâ€ for your interview</h2>
<blockquote><p>â€œStructs are value types â€” stored inline, copied by value, no GC involvement, ideal for small immutable data like ticks or coordinates. Classes are reference types â€” heap-allocated, reference-based, and managed by GC. I use structs where I want predictable lifetimes and zero allocations; classes when I need shared, long-lived state or polymorphism.â€</p></blockquote>
<p>---</p>
<p>Would you like me to now create a <strong>visual of memory layout with stack/heap arrows</strong> (an actual diagram you could memorize or even sketch during the interview)? It would show <code>struct</code>, <code>class</code>, and mixed cases (struct-in-class, class-in-struct) clearly.</p>
      </article>
    </main>
  </div>
  <footer class="footer">Built for disciplined study & interview drills.</footer>
  <script>
    (() => {
      const select = document.getElementById('theme-select');
      const supported = ['dark2', 'light', 'dark'];
      const saved = sessionStorage.getItem('study-theme');
      const normalized = saved === 'midnight' ? 'dark2' : saved;
      const fallback = 'light';
      const initial = supported.includes(normalized) ? normalized : (window.__studyTheme || fallback);
      document.documentElement.dataset.theme = initial;
      if (select) {
        select.value = initial;
        select.addEventListener('change', (event) => {
          const value = event.target.value;
          const next = supported.includes(value) ? value : fallback;
          document.documentElement.dataset.theme = next;
          sessionStorage.setItem('study-theme', next);
        });
      }
    })();
    (() => {
      const groups = document.querySelectorAll('.sidebar-group');
      if (!groups.length) return;
      const storageKey = 'study-open-groups';
      const saved = sessionStorage.getItem(storageKey);
      const openFromStorage = new Set(saved ? JSON.parse(saved) : []);

      const activeLink = document.querySelector('.nav-link.active');
      const activeGroup = activeLink?.closest('.sidebar-group');
      if (activeGroup?.dataset.group) {
        openFromStorage.add(activeGroup.dataset.group);
      }

      const syncStorage = () => {
        const openIds = Array.from(document.querySelectorAll('.sidebar-group.is-open'))
          .map((group) => group.dataset.group)
          .filter(Boolean);
        sessionStorage.setItem(storageKey, JSON.stringify(openIds));
      };

      const setExpanded = (group, expanded) => {
        const header = group.querySelector('.sidebar-group__header');
        const list = group.querySelector('.sidebar-group__items');
        group.classList.toggle('is-open', expanded);
        header?.setAttribute('aria-expanded', expanded);
        if (list) {
          list.hidden = !expanded;
        }
      };

      groups.forEach((group) => {
        const shouldOpen = openFromStorage.has(group.dataset.group);
        setExpanded(group, shouldOpen);
        const header = group.querySelector('.sidebar-group__header');
        header?.addEventListener('click', () => {
          const next = !group.classList.contains('is-open');
          setExpanded(group, next);
          syncStorage();
        });
      });
    })();
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        const swPath = '..\../service-worker.js';
        navigator.serviceWorker.register(swPath).catch((err) => {
          console.error('Service worker registration failed', err);
        });
      });
    }
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-csharp.min.js"></script>
</body>
</html>